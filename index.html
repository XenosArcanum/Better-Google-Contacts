<!DOCTYPE html>


<html lang="en">
   <head>
  		<title>
         Better Google Contacts
       </title>

       <meta charset="utf-8" />
       <meta name="viewport" content="width=device-width, initial-scale=1">

		<center>
       		<h1>Better Google Contacts</h1>
		</center>
  </head>

  <body>
  	<center>

	    

	    <button id="signin-button">Sign In</button>
	    <button id="signout-button">Sign Out</button>

	    <button id="authorize-button" style="display: none;">Authorize</button>
		<button id="signout-button" style="display: none;">Sign Out</button>

  		<script src="https://apis.google.com/js/api.js">
	  
	    </script>

	  	<script type=module>

	  		import {GOOGLE_API_CLIENT_ID} from "./Secret.js"

		      function handleClientLoad() 
		      {
		        // Loads the client library and the auth2 library together for efficiency.
		        // Loading the auth2 library is optional here since `gapi.client.init` function will load
		        // it if not already loaded. Loading it upfront can save one network request.
		        gapi.load('client:auth2', initClient);
		      }

		      function initClient() 
		      {
		        // Initialize the client with API key and People API, and initialize OAuth with an
		        // OAuth 2.0 client ID and scopes (space delimited string) to request access.
		        gapi.client.init({
		            // apiKey: 'YOUR_API_KEY',
		            discoveryDocs: ["https://people.googleapis.com/$discovery/rest?version=v1"],
		            clientId: GOOGLE_API_CLIENT_ID,
		            scope: "https://www.googleapis.com/auth/contacts"
		        				}).then(function () 
		        {
		          // Listen for sign-in state changes.
		          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

		          // Handle the initial sign-in state.
		          updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
		        });
		      }

		      function updateSigninStatus(isSignedIn) 
		      {
		        // When signin status changes, this function is called.
		        // If the signin status is changed to signedIn, we make an API call.
		        if (isSignedIn) 
		        {
		          makeApiCall();
		        }
		      }

		      function handleSignInClick(event) 
		      {
		        // Ideally the button should only show up after gapi.client.init finishes, so that this
		        // handler won't be called before OAuth is initialized.
		        gapi.auth2.getAuthInstance().signIn();
		      }

		      function handleSignOutClick(event) 
		      {
		        gapi.auth2.getAuthInstance().signOut();
		      }

		      function makeApiCall() 
		      {
		        // Make an API call to the People API, and print the user's given name.
		        gapi.client.people.people.get({
		          'resourceName': 'people/me',
		          'requestMask.includeField': 'person.names'
		        }).then(function(response) {
		          console.log('Hello, ' + response.result.names[0].givenName);
		        }, function(reason) {
		          console.log('Error: ' + reason.result.error.message);
		        });
		      }

		      handleClientLoad();


		   </script>

		<div id="content"></div>

		</center>
	</body>
  </body>
</html>